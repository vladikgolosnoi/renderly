# Трассировка требований Renderly

| Критерий / требование                                | Где реализовано                                                                                              | Как проверить                                                                                                      |
|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| Конфигурируемая библиотека блоков                    | `apps/api/app/models/block_definition.py`, `apps/api/app/seeds/block_definitions.json`, `app/services/block_registry.py` | Запустить `python -m app.seeds.seed_data`, затем `GET /api/catalog/blocks` и убедиться, что приходят типы блоков.    |
| Drag & drop редактор                                 | `apps/web/src/views/EditorView.vue`, `components/BlockPalette.vue`, `components/EditorCanvas.vue`, store `project.ts`   | В веб‑клиенте создать проект, перетаскивать блоки, менять порядок и наблюдать автосохранение.                      |
| Публикация и экспорт HTML                            | `apps/api/app/api/routes/publish.py`, `app/services/publisher.py`, модель `PublishedVersion`                  | Выполнить `POST /api/projects/{id}/publish`, затем `GET /api/projects/{id}/published/latest` и открыть HTML ссылку. |
| Темы проекта, header/footer                          | `Project.theme`/`Project.settings`, UI `ThemeDesigner.vue`, seeds                                             | В Theme Designer поменять цвета/тексты, сохранить и убедиться что preview и экспорт используют новые значения.      |
| Дизайнер тем / библиотека палитр                     | `ThemeDesigner.vue`, API `/api/themes`, миграция `20251108_02_theme_templates.py`                             | Создать тему через UI, проверить ответ `GET /api/themes`, применить шаблон к проекту.                               |
| Администрирование блоков (CRUD)                      | API `/api/catalog/blocks`, `BlockAdminView.vue`, store `blockAdmin.ts`                                        | Залогиниться админом, открыть `/admin/blocks`, создать/изменить тип блока и проверить, что он появляется в палитре. |
| Импорт/экспорт JSON проектов                         | `projects.py` (`/export`, `/import`), `services/publisher.py:snapshot_project`                                | `GET /api/projects/{id}/export`, сохранить JSON, затем `POST /api/projects/import` и убедиться, что создаётся копия.|
| CDN публикации (MinIO)                               | `services/cdn.py`, `services/publisher.py`, `routes/publish.py`, `infra/docker-compose.yml`                   | После публикации проверить поле `cdn_url` и наличие файла в бакете MinIO (`renderly-pages`).                        |
| Live preview и SSR                                   | `/api/projects/{id}/preview`, `LivePreview.vue`, `ShareView.vue`, `services/publisher.render_project_html`    | В редакторе кликнуть «Live Preview», сверить HTML с ответом API и SSR страницей по share‑ссылке.                    |
| Share‑links и гостевые комментарии                   | `/api/projects/{id}/share-links`, `/api/shares/{token}`, `/api/shares/{token}/comments`, `ShareView.vue`      | Создать ссылку, открыть публичную страницу без авторизации, оставить комментарий и проверить его появление.         |
| Формы и вебхуки                                       | Блок `form` (`BlockForm.vue`), `/api/forms/submit`, `services/forms.py`, модель `FormSubmission`              | Отправить форму на опубликованной странице, посмотреть запись в БД и статус доставки в логах worker.                |
| Аналитика лидов                                      | `/api/analytics/leads`, `AnalyticsView.vue`, модели `FormSubmission`, `LeadAnalyticsResponse`                 | Собрать несколько заявок, вызвать эндпоинт с фильтрами и сверить графики/таблицы в UI.                              |
| Кастомные домены и верификация                       | `ProjectSettings.vue` (раздел доменов), модели `ProjectDomain`, сервис `domain_manager`, nginx proxy           | Добавить домен, настроить CNAME, вызвать `/api/projects/{id}/domains/{domain_id}/verify` и открыть сайт по домену.  |
| Маркетплейс шаблонов                                 | `MarketplaceView.vue`, `/api/templates`, `models/community_template.py`                                       | Опубликовать проект в маркетплейс, убедиться что карточка появляется в списке и поддерживается импорт.             |
| Менеджер ассетов                                     | `AssetManager.vue`, `services/assets.py`, `/api/assets/*`, MinIO `renderly-assets`                            | Загрузить изображение в редакторе, проверить presigned URL, thumbnail и выдачу через `/api/assets/{id}/content`.    |

